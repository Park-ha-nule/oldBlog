---
layout: post
title:  AWS 서버 환경 만들기
date:   2020-07-08 20:24:00 +0000
description: AWS 서버 환경 만들기
img: AWS.png
tags: [More]
author: begginer_
---

# AWS 서버 환경 만들기

---

- AWS란?

    Amazon Web Service의 약자로 웹과 모바일의 애플리케이션에 이르는 거의 모든 물리적 컴퓨팅 자원을 클라우드를 통하여 실행할 수 있는 다양한 인프라 및 애플리케이션 서비스 집합을 제공한다. 

 외부에서 내가 만든 서비스에 접근하려면 서버가 **24시간 작동**되어야 한다. 선택지는 3가지가 있다.

- 집에 pc를 24시간 구동한다.
- 호스팅 서비스(Cafe 24, 코리아호스트)를 이용한다.
- 클라우드 서비스(AWS)를 이용한다.

 비용적인 면으로는 위의 2가지가 적합하지만, 특정 시간에 트래픽이 몰린다면 **유동적으로 사양을 늘릴 수 있는 클라우드**가 유리하다. 

- 클라우드란?

    : 여기서 클라우드 서비스란 인터넷(클라우드)를 이용하여 서버, 스토리지, 데이터베이스, 네트워크 등의 컴퓨팅 서비스를 제공하는 것을 말한다. 단순히 물리 장비를 대여하는 것으로 생각할 수 있지만 아니다. 

     AWS의 EC2는 서버 장비를 대여하는 것이지만, 실제로는 (로그관리, 모니터링, 하드웨어 교체)등을 기본적으로 지원하고 있다. 개발자가 직접 해야 할 일을 AWS가 전부 지원하는 것이다. 

    - 클라우드 형태
        1. Infrastructure as a Service(IaaS, 아이아스, 이에스)
            - 가상머신, 스토리지 등 IT 인프라를 대여해 주는 서비스라고 보면 된다.
            - AWS의 EC2, S3 등
        2. Platform as a Service(Paas, 파스)
            - IaaS를 한번 더 추상화한 서비스
            - 많은 기능이 자동화되어있음
            - AWS의 빈스톡, 헤로쿠 등
        3. Software as a Service(Saas, 사스)
            - 소프트웨어 서비스를 이야기한다.
            - 구글 드라이브, 드랍박스 등

 내가 쓸 AWS서비스는 IaaS이다. 그 이유는 빈스톡을 사용하면 대부분 작업이 간소화되지만, **프리티어로 무중단 배포(다운타임이 없는)가 불가능하기 때문**이다. 

- 무중단 배포란?

    : 우리가 일반적으로 간단하게 서버를 배포하는 순서를 생각해보자

    8080포트에 우리의 서버를 띄운다 → 새롭게 배포할 내용이 있다면 포트가 충돌되면 안 되기 때문에 서버를 다운시킨다. → 공사중 이미지를 띄운다. → 8080포트에 새롭게 배포할 서버를 띄운다.

     서버가 뜨는데 30초가 걸린다고 한다면 최소 30+@초만큼의 다운타임이 발생하는데 현대에는 이런 다운타임이 없는 무중단 배포를 지원해야한다. 

### 1-1. EC2 인스턴스 생성

---

 

- EC2(Elastic Compute Cloud)란?

     EC2는 AWS에서 제공하는 서버를 대여해준 거라고 생각하면 된다. 쉽게 말해, 개발자가 해야할일을 AWS가 지원해준다고 생각하면 된다.

인스턴스는 EC2 서비스에 생성된 가상머신을 이야기한다. 

 인스턴스를 생성하는 첫 단계는 AMI(Amazon Machine Image)를 선택하는 것이다. 

- AMI란?

     여기서 AMI란 EC2 인스턴스를 시작하는데 필요한 정보를 **이미지로 만들어 둔 것**을 의미한다. 이스턴스라는 가상 머신에 운영체제 등을 설치할 수 있게 구워 넣은 이미지로 생각하면 된다. 

 다음 단계는 스토리지 선택이다. 스토리지는 **하드디스크**라고 불리는 서버의 디스크를 이야기하며 **서버의 용량**을 정하는 것이다. 

 다음으로 보안 그룹이다. 보안 그룹은 **방화벽**을 의미한다. '서버로 80포트 외에는 허용하지 않는다'는 역할을 하는 방화벽이 AWS에서는 보안 그룹으로 사용된다.

---

 인스턴스로 접근하기 위해선 pem키(비밀키)가 필요하다. 인스턴스는 해당 pem 키 외에는 접근을 허용하지 않는다. 

생성이 다 되면 IP와 도메인이 할당된다. 인스턴스도 결국 하나의 서버이기 때문에 IP가 존재한다. 인스턴스 생성 시에 항상 새 IP를 할당하는데, 같은 인스턴스를 중지하고 **다시 시작할 때도 새 IP가 할당된다.** 

즉, 요금을 아끼려고 인스턴스를 중지하고 다시 시작하면 IP가 변경된다. 이렇게 되면 매번 접속해야하는 번거로움이 발생한다. 그래서 **매번 변경되지 않고 고정 IP를 가지게 해야한다.** 그게 **고정 IP**이다. 

- EIP(Elastic IP) 할당

 AWS의 고정 IP를 생성하고 EC2 주소를 연결하면 된다. 여기까지 진행했다면 EC2 인스턴스 생성 과정은 끝났다. 

여기서 주의할 점은, 탄력적 IP는 무조건 EC2에 바로 연결해야 한다. 

만약, 더는 사용할 인스턴스가 없을 때도 탄력적 IP를 삭제해야한다. 비용 청구가 되기 때문에 잊지 않고 삭제해야한다. 

### 1-2. EC2 서버 접속

---

putty는 pem 키로 사용이 안된다. pem 키를 ppk 파일로 변환을 해줘야한다. puttygen은 이 과정을 진행해주는 클라이언트이다.